<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Opdracht mod_rewrite: blog</title>
        <link rel="stylesheet" href="http://web-backend.local/css/global.css">
        <link rel="stylesheet" href="http://web-backend.local/css/facade.css">
        <link rel="stylesheet" href="http://web-backend.local/css/directory.css">
    </head>
    <body class="web-backend-opdracht">
        
        <section class="body">

            <style>
                
                .query-content,
                .query-date
                {
                    margin:18px 0;
                }

                .query-content input,
                .query-content label,
                .query-date input,
                .query-date label,
                {
                    display:inline;
                }

            </style>
            
            <h1>Opdracht mod_rewrite: blog</h1>

            <ul>
                <li>De bedoeling van deze opdracht is om een kleine blog-module te maken, inclusief url-rewriting.</li>

                <li>Werk zoveel mogelijk met klasses.</li>

                <li>
                    Maak een nieuwe database aan met een tabel 'artikels' en de volgende kolommen:
                    <ul>
                        <li>Index (=primary key)</li>
                        <li>Titel (=text)</li>
                        <li>Artikel (=text)</li>
                        <li>Kernwoorden (=text)</li>
                        <li>Datum (= date)</li>
                    </ul>
                </li> 
            </ul>

            <h1>Opdracht mod_rewrite: blog: deel 1: artikel-toevoegen-form.php</h1>

            <ul>
                <li>
                    Deze pagina bevat een invulformier waarmee je artikels kan toevoegen. Dit ziet er ongeveer als volgt uit:
                    <div class="facade-minimal" data-url="http://www.app.local/artikels-toevoegen-form.php">
                                
                        <h1>Artikel toevoegen</h1>

                        <a href="">Terug naar overzicht</a>

                        <form>
                            <ul>
                                <li>
                                    <label for="titel">Titel</label>
                                    <input type="text" id="titel" name="titel">
                                </li>
                                <li>
                                    <label for="artikel">Artikel</label>
                                    <textarea id="artikel" name="artikel"></textarea>
                                </li>
                                <li>
                                    <label for="kernwoorden">Kernwoorden</label>
                                    <input type="text" id="kernwoorden" name="kernwoorden">
                                </li>
                                <li>
                                    <label for="datum">Datum</label>
                                    <input type="date" id="datum" name="datum">
                                </li>
                            </ul>
                            <input type="submit" name="submit">
                        </form>
                    </div>
                </li>

                <li>Het formulier heeft een action die verwijst naar artikel-toevoegen.php</li>
            </ul>

            <h1>Opdracht mod_rewrite: blog: deel 2: artikel-toevoegen.php</h1>

            <ul>
                <li>Dit is de verwerkingspagina die de data uit het formulier artikel-toevoegen-form.php opvangt</li>

                <li>De data uit het formulier moet aan de database toegevoegd worden.</li>

                <li class="remark">De datum moet worden samengesteld volgens de manier waarop SQL dit verwacht (jjjj-mm-dd)</li>

                <li>Als de insert gelukt is, maak dan de juiste boodschap aan (bv. dmv flashdata/<code>$_SESSION['notification']</code> en redirect naar artikel-overzicht.php</li>

                <li>Als de insert niet gelukt is, maak dan de juiste boodschap aan (bv. dmv flashdata/<code>$_SESSION['notification']</code> en redirect naar artikel-toevoegen-form.php Zorg er dan ook voor dat de ingevulde data, opnieuw in het formulier is ingevuld zodat de gebruiker dit niet opnieuw hoeft te doen.</li>

                <li><span class="tip">Vergeet je sessie niet te openen op de pagina's waar dit nodig is.</span></li>
            </ul>

            <h1>Opdracht mod_rewrite: blog: deel 3: artikel-overzicht.php</h1>

            <ul>
                <li>Toon de juiste boodschap (indien deze geset is) en verwijder deze dan uit de <code>$_SESSION</code> van zodra de boodschap is weergegeven.</li>
            </ul>

            <h1>Opdracht mod_rewrite: blog: deel 4: artikel-overzicht.php</h1>

            <ul>
                <li>Deze ziet er ongeveer als volgt uit:
                    
                    <div class="facade-minimal" data-url="http://www.app.local/artikels-overzicht.php">
                        
                        
                         <form class="query-content">
                            <label for="query-content">Zoeken in artikels:</label>
                            <input type="text" name="query-content" id="query-content">
                            <input type="submit" value="Zoeken">
                        </form>
                        
                        <form class="query-date">
                            <label for="query-date">Zoeken op datum:</label>
                            <select name="query-date" id="query-date">
                                
                                <option value="2010">2010</option>
                                <option value="2011">2011</option>
                                <option value="2012">2012</option>
                                <option value="2013">2013</option>
                                <option value="2014">2014</option>
                                <option value="2015">2015</option>
                                <option value="2016">2016</option>
                                <option value="2017">2017</option>
                                <option value="2018">2018</option>
                                
                            </select>
                            <input type="submit" value="Zoeken">
                        </form>

                        <h1>Artikels overzicht</h1>                         

                        <a href="">Artikel toevoegen</a>

                        <article>
                            <h2>Kantar: Apple On Track For 'Record Quarter' As iPhone 6 Sales Bump Up Its Market Share Vs. Android | 2014-12-04</h2>
                            <p>Apple has been seeing its smartphone market share erode over the last several years as its simple-and-small line up of iPhones competed against model after model of low-priced, big-screened, fancy-featured Android-based handsets. But it looks like its latest iPhone 6 models — with their larger faces, 4G compatibility and Apple Pay support — may be helping it turn the tide a bit.</p>
                            <p>Keywords: Computers, Consumer Electronics, Hardware + Software</p>
                        </article>

                        <article>
                            <h2>Gangnam Style Has Been Viewed So Many Times It Broke YouTube's Code | 2014-12-04</h2>
                            <p>Whoops! Just a fun bit of trivia for the coders out there: PSY's Gangnam Style has been viewed so many times that it broke YouTube's view counter, making it the very first video to break the reaches of a 32-bit integer.</p>
                            <p>Keywords: Popular, YouTube, Psy, Gangnam Style</p>
                        </article>

                        <article>
                            <h2>Stripe Raises Another $70 Million, Doubling Its Valuation To $3.5 Billion | 2014-12-04</h2>
                            <p>Ultra-hot payments startup Stripe has brought on $70 million in new funding that will double its valuation less than a year after its last raise. The round, which was first reported by the Financial Times, brings the total amount Stripe has raised to more than $200 million.</p>
                            <p>Keywords: Payments, Software, Credit Cards</p>
                        </article>
                    </div>

                </li>

                <li>'Zoeken in artikels' is een apart formulier met een action naar artikel-zoeken.php en een GET als method.</li>

                <li>'Zoeken op datum' is een apart formulier met een action naar artikel-zoeken.php en een GET als method.</li>

                <li>De artikels die onderaan getoond worden zijn alle artikels in de database.
                    
                    <ul>
                        <li>Elk artikel staat in een correct HTML-element bv. <code>&lt;article&gt;</code></li>
                    </ul>
                </li>          
            </ul>

            <h1>Opdracht mod_rewrite: blog: deel 5: artikel-zoeken.php</h1>

            <ul>
                <li>Deze staat in voor het weergeven van de zoekresultaten.</li>

                <li>Wanneer er op een woord wordt gezocht, stel dan een WHERE-clause in op de artikel kolom. Er hoeft enkel gezocht te worden in de tekst van het artikel.</li>

                <li>Wanneer er op een datum wordt gezocht, stel dan een WHERE-clause in op de datum kolom. Het volstaat om enkel te zoeken op het jaargetal.</li>

                <li>Toon de resultaten op dezelfde manier als in artikel-overzicht.php

                    <div class="facade-minimal" data-url="http://www.app.local/artikels-search.php?query-content=apple">
                    
                        <a href="">Terug naar overzicht</a>

                        <form class="query-content">
                            <label for="query-content">Zoeken in artikels:</label>
                            <input type="text" name="query-content" id="query-content" value="apple">
                            <input type="submit" value="Zoeken">
                        </form>
                        
                        <form class="query-date">
                            <label for="query-date">Zoeken op datum:</label>
                            <select name="query-date" id="query-date">
                                
                                <option value="2010">2010</option>
                                <option value="2011">2011</option>
                                <option value="2012">2012</option>
                                <option value="2013">2013</option>
                                <option value="2014">2014</option>
                                <option value="2015">2015</option>
                                <option value="2016">2016</option>
                                <option value="2017">2017</option>
                                <option value="2018">2018</option>
                                
                            </select>
                            <input type="submit" value="Zoeken">
                        </form>

                        <h1>Artikels die het woord "Apple" bevatten</h1>                         

                        <article>
                            <h2>Kantar: Apple On Track For 'Record Quarter' As iPhone 6 Sales Bump Up Its Market Share Vs. Android | 2014-12-04</h2>
                            <p>Apple has been seeing its smartphone market share erode over the last several years as its simple-and-small line up of iPhones competed against model after model of low-priced, big-screened, fancy-featured Android-based handsets. But it looks like its latest iPhone 6 models — with their larger faces, 4G compatibility and Apple Pay support — may be helping it turn the tide a bit.</p>
                            <p>Keywords: Computers, Consumer Electronics, Hardware + Software</p>
                        </article>
                    </div>
                </li>

                <li>Als je alles aan de praat hebt gekregen, slaag de oefening best even op en maak je een kopie om aan het volgende deel te beginnen</li>
            </ul>

            <h1>Opdracht mod_rewrite: blog: deel 6: URL-rewriting</h1>

            <ul>
                <li>De bedoeling is nu om van elke pagina een cleane URL te maken (dus geen verwijzingen meer naar .php-bestanden, maar naar mappen). Dit doen we door middel van de mod_rewrite module van Apache en de .htaccess file</li>

                <li> Zorg ervoor dat wanneer je naar http://www.app.local/artikels/ surft, je op http://www.app.local/artikel-overzicht.php terecht komt.</li>

                <li>Zorg ervoor dat wanneer je naar http://www.app.local/artikels/toevoegen/ surft, je op http://www.app.local/artikel-toevoegen-form.php terecht komt</li>

                <li>Zorg ervoor dat wanneer je naar http://www.app.local/artikels/toevoegen/confirm/ surft, je op http://www.app.local/artikel-toevoegen.php terecht komt</li>

                <li>Zorg er nu voor dat alles werkt zoals het moet (de zoeken pagina even buiten beschouwing gelaten)</li>

                <li>Pas daarna alle doorverwijzingen (url's, a hrefs, ...) aan zodat ze verwijzen naar deze cleane urls. Dus, nergens een link naar een .php-bestand
                    
                    <ul>
                        <li>Hiervoor moet je gebruik maken van de absolute pathname bij verwijzingen naam andere pagina's.</li>

                        <li>Deze kan je hard coderen bv <code>$basePath = 'absolute pathname'</code></li>

                        <li>Of (=beter): deze roep je op door middel van <code>$_SERVER['REQUEST_URI']</code>
                            <ul>
                                <li>Let wel op wanneer je deze methode gebruikt: is dit de correcte pathname?</li>

                                <li>Manipuleer deze pathname zodat je uitkomt op de gewenste absolute path-name </li>
                            </ul>
                        </li>
                    </ul>

                </li>

                <li>Dit is een moeilijk en frustrerend werkje. Kijk goed naar de URL en analyseer wat er gebeurt.</li>

                <li>
                    Tijd om de zoeken-pagina onder handen te nemen. De bedoeling is om de zoektermen ook friendly urls te geven.
                    
                    <ul>
                        <li>Wanneer er gezocht wordt op een woord 'test', moet de url er als volgt uitzien: http://www.app.local/artikels/zoeken/content/test/</li>

                        <li>Wanneer er gezocht wordt op een datum '2008', moet de url er als volgt uitzien: http://www.app.local/artikels/zoeken/datum/2008/</li>

                        <li>Dit wil zeggen dat er een aparte pagina gemaakt moet worden, omdat het niet mogelijk is om via een formulier naar cleane url te surfen, enkel naar een url met GET-variabelen.</li>

                        <li>Maak daarom een nieuwe pagina aan: artikel-zoeken-redirect.php
                        
                            <ul>
                                <li>Deze pagina staat in voor het interpreteren van de get-variabele.</li>

                                <li>Wanneer de <code>$_GET</code> de key <code>query-content</code> bevat moet de url http://www.app.local/artikels/zoeken/content/####/ worden, waarbij de #### staat voor de ingegeven zoekterm</li>

                                <li>Wanneer deze <code>$_GET</code> de key <code>query-date</code> bevat moet de url http://www.app.local/artikels/zoeken/datum/####/ worden, waarbij #### staat voor de datum waarop gezocht moet worden</li>

                                <li>Ook deze pagina heeft een alias http://www.app.local/artikels/zoeken/</li>

                                <li>Zorg er dus voor dat het inputformulier op de overzichtspagina ook naar deze cleane url verwijst.</li>

                                <li>Test dit uitvoerig! Er zullen hier en daar nog enkele 'gaten' (wat gebeurt er als je zoek naar een lege string?, ...) ziten. Probeer deze zo goed mogelijk op te vangen.</li>
                            </ul>

                        </li>
                    </ul>
                </li>
            </ul>

            <h1>Opdracht mod_rewrite: blog: superuitbreiding</h1>

            <ul>
                <li>
                    Zorg ervoor dat wanneer je naar 
                    <ul>
                        <li>http://www.app.local/artikels/zoeken/datum/2012/01/ surft je alle artikels van die specifieke maand terugkrijgt.</li>
                        <li>http://www.app.local/artikels/zoeken/datum/2012/01/01/ surft je alle artikels van die specifieke dag terugkrijgt.</li>

                    </ul>
                </li>
                <li>Toon een boodschap wanneer er niets gevonden werd.</li>
            </ul>
            
        </section>
   
    </body>
</html>
