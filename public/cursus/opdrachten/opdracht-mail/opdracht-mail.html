<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Opdracht mail</title>
        <link rel="stylesheet" href="http://web-backend.local/css/global.css">
        <link rel="stylesheet" href="http://web-backend.local/css/facade.css">
        <link rel="stylesheet" href="http://web-backend.local/css/directory.css">
    </head>
    <body class="web-backend-opdracht">
        
        <section class="body">
        
            <h1>Opdracht mail</h1>

            <ul>

                <li>Deze opdracht is een simpel contactformulier, waarbij een gebruiker zijn e-mailadres en boodschap invult en aanvinkt of hij een kopie van het bericht wenst.
                </li>

                <li>Dit formulier wordt afgehandeld door een php-script dat het bericht toevoegt zowel aan de database als naar de desbetreffende personen verstuurt (minstens de admin/bedrijf en mogelijk ook de afzender zelf).</li>

                <li>Het resultaat ziet er ongeveer als volgt uit:

                    <div class="facade-minimal" data-url="http://www.app.local/contact-form.php">
                                
                        <h1>Contacteer ons</h1>

                        <form>
                            <ul>
                                <li>
                                    <label for="email">E-mailadres</label>
                                    <input type="text" id="email" name="email">
                                </li>
                                <li>
                                    <label for="message">Boodschap</label>
                                    <textarea name="message" id="message" cols="30" rows="10"></textarea>
                                </li>
                                <li>
                                    <input type="checkbox" name="copy" id="copy">
                                    <label for="copy">Stuur een kopie naar mezelf</label>
                                </li>
                            </ul>
                            <input type="submit" name="submit">
                        </form>
                    </div>
                </li>

                <li>De structuur ziet er ongeveer als volgt uit:
                    <ul class="directory">
                        <li class="file">contact.php</li>
                        <li class="file">contact-form.php</li>
                    </ul>
                </li>

                <li>
                    Maak een aparte database aan. Deze bevat een tabel contact_messages en heeft volgende kolommen:
                    <ul>
                        <li>id (PK)</li>
                        <li>email (varchar)</li>
                        <li>message (text)</li>
                        <li>time_sent (datetime)</li>
                    </ul>
                </li>
            </ul>
 
        <h1>Opdracht mail: deel 1 - contact-form.php</h1>

        <ul>
            <li>
                Maak een html-document met formulier dat er als volgt uitziet:

                <div class="facade-minimal" data-url="http://www.app.local/contact-form.php">
                                
                    <h1>Contacteer ons</h1>

                    <form>
                        <ul>
                            <li>
                                <label for="email">E-mailadres</label>
                                <input type="text" id="email" name="email">
                            </li>
                            <li>
                                <label for="message">Boodschap</label>
                                <textarea name="message" id="message" cols="30" rows="10"></textarea>
                            </li>
                            <li>
                                <input type="checkbox" name="copy" id="copy">
                                <label for="copy">Stuur een kopie naar mezelf</label>
                            </li>
                        </ul>
                        <input type="submit" name="submit">
                    </form>
                </div>
            </li>

            <li>De action van het formulier verwijst naar <span class="directory-sa-file">contact.php</span></li>

            <li>Zorg ervoor dat er foutboodschappen kunnen getoond worden door middel van een <code>$_SESSION</code> variabele</li>

            <li>Zorg ervoor dat er wanneer er iets mis gaat bij het versturen van een email, de reeds ingevulde data bewaard blijft en ingevuld wordt in de nodige velden. Ook door middel van een <code>$_SESSION</code> variabele</li>
        </ul>

        <h1>Opdracht mail: deel 2 - contact.php</h1>

        <ul>
            <li>
                Deze pagina controleert of de nodige post-waarde geset zijn
                <ul>
                    <li>Zonee: foutbooschap instellen en redirecten</li>
                </ul>
            </li>

            <li>Definieer een variabele <code>$admin</code>. Deze variabele zal het e-mailadres van de ontvanger bevatten <span class="tip">@hotmail.com-adressen worden standaard geblokkeerd</span></li>

            <li>Prepareer de post-data zodat ze inserteerbaar is in de database</li>

            <li>Maak een connectie met de database en voeg het bericht toe.</li>

            <li>Als het invoegen gelukt is, controleer dan of de 'stuur een kopie naar mijzelf' aangevinkt is. Zoja, moet er een mail verstuurd worden naar de persoon die de mail heeft opgesteld.</li>

            <li>Zorg ervoor dat er in de body van de mails HTML kan verwerkt worden om de mails een mooi uiterlijk te geven. <span>Je kan hiervoor <code>headers</code> gebruiken, of zelfs een externe mailer-class.</span></li>

            <li>Stuur een mail met het bericht naar de admin.</li>

            <li>
                Als het versturen van de mails gelukt is: succesboodschap instellen, redirecten naar <span class="directory-sa-file">contact-form.php</span> en niet vergeten de <code>$_SESSION</code> variabele die instaat voor het onthouden van eventuele post-data te unsetten.
                <ul>
                    <li>Als het versturen niet gelukt is: foutbooschap instellen, redirecten naar <span class="directory-sa-file">contact-form.php</span> en de input-velden op basis van de <code>$_POST</code> array opnieuw invullen zodat de ingevulde waarden niet verloren gaan.</li>
                </ul>
            </li>

        </ul>

        </section>

    </body>
</html>
